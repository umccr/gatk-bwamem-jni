name: build
permissions:
  contents: write
  pull-requests: write
  actions: read

on: push
#   push:
#     tags:
#       - '*'

jobs:
  # build-linux-aarch64:
  #   runs-on: ubuntu-24.04-arm
  #   steps:
  #     - name: Checkout repository
  #       uses: actions/checkout@v4
  #       with:
  #         submodules: true
  #     - name: Set up dependencies
  #       run: |
  #         sudo apt-get update
  #         sudo apt-get install -y build-essential gradle
  #     - name: Set up Java
  #       uses: actions/setup-java@v4
  #       with:
  #         java-version: '17'
  #         distribution: 'corretto'
  #     - name: Build with Gradle
  #       run: ./gradlew build
  #     - name: Upload artifact
  #       uses: actions/upload-artifact@v4
  #       with:
  #         name: libbwa.linux-aarch64.so
  #         path: ./build/resources/main/libbwa.linux-aarch64.so

  # build-linux-x86_64:
  #   runs-on: ubuntu-22.04
  #   steps:
  #     - name: Checkout repository
  #       uses: actions/checkout@v4
  #       with:
  #         submodules: true
  #     - name: Set up dependencies
  #       run: |
  #         sudo apt-get update
  #         sudo apt-get install -y build-essential gradle
  #     - name: Set up Java
  #       uses: actions/setup-java@v4
  #       with:
  #         java-version: '17'
  #         distribution: 'corretto'
  #     - name: Build with Gradle
  #       run: ./gradlew build
  #     - name: Upload artifact
  #       uses: actions/upload-artifact@v4
  #       with:
  #         name: libbwa.linux-x86_64.so
  #         path: ./build/resources/main/libbwa.linux-x86_64.so

  # build-macos-intel:
  #   runs-on: macos-13
  #   steps:
  #     - name: Checkout repository
  #       uses: actions/checkout@v4
  #       with:
  #         submodules: true
  #     - name: Set up Java
  #       uses: actions/setup-java@v4
  #       with:
  #         java-version: '17'
  #         distribution: 'corretto'
  #     - name: Build with Gradle
  #       run: ./gradlew build
  #     - name: Upload artifact
  #       uses: actions/upload-artifact@v4
  #       with:
  #         name: libbwa.osx-x86_64.dylib
  #         path: ./build/resources/main/libbwa.osx-x86_64.dylib

  # build-macos-arm64:
  #   runs-on: macos-latest
  #   steps:
  #     - name: Checkout repository
  #       uses: actions/checkout@v4
  #       with:
  #         submodules: true
  #     - name: Set up Java
  #       uses: actions/setup-java@v4
  #       with:
  #         java-version: '17'
  #         distribution: 'corretto'
  #     - name: Build with Gradle
  #       run: ./gradlew build
  #     - name: Upload artifact
  #       uses: actions/upload-artifact@v4
  #       with:
  #         name: libbwa.osx-arm64.dylib
  #         path: ./build/resources/main/libbwa.osx-arm64.dylib

  build-windows-x86_64:
    runs-on: windows-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          submodules: true
      - name: Set up Java
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'corretto'
      - name: Setup Gradle
        uses: gradle/actions/setup-gradle@v4

      - name: Run build with Gradle wrapper
        run: ./gradlew build --scan

      - name: Upload build reports
        uses: actions/upload-artifact@v4
        with:
          name: build-reports
          path: **/build/reports/
